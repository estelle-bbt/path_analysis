<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Sampling oMS</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting-01c78b5cd655e4cd89133cf59d535862.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap-11df3c80491ea81009d83f04e2a62a23.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="index_files/libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="index_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="index_files/libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">
<script src="index_files/libs/vis-9.1.0/vis-network.min.js"></script>
<script src="index_files/libs/visNetwork-binding-2.1.2/visNetwork.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#project-and-data-vizualisation" id="toc-project-and-data-vizualisation" class="nav-link active" data-scroll-target="#project-and-data-vizualisation">Project and data vizualisation</a></li>
  <li><a href="#what-is-the-best-proxy-for-observational-mating-success" id="toc-what-is-the-best-proxy-for-observational-mating-success" class="nav-link" data-scroll-target="#what-is-the-best-proxy-for-observational-mating-success">What is the best proxy for observational mating success?</a>
  <ul class="collapse">
  <li><a href="#acp" id="toc-acp" class="nav-link" data-scroll-target="#acp">ACP</a>
  <ul class="collapse">
  <li><a href="#carry-over-10" id="toc-carry-over-10" class="nav-link" data-scroll-target="#carry-over-10">Carry-over 10</a></li>
  <li><a href="#carry-over-5" id="toc-carry-over-5" class="nav-link" data-scroll-target="#carry-over-5">Carry-over 5</a></li>
  <li><a href="#carry-over-20" id="toc-carry-over-20" class="nav-link" data-scroll-target="#carry-over-20">Carry-over 20</a></li>
  </ul></li>
  <li><a href="#correlation-test" id="toc-correlation-test" class="nav-link" data-scroll-target="#correlation-test">Correlation test</a></li>
  <li><a href="#linear-models-and-r2" id="toc-linear-models-and-r2" class="nav-link" data-scroll-target="#linear-models-and-r2">Linear models and R<sup>2</sup></a></li>
  <li><a href="#aic" id="toc-aic" class="nav-link" data-scroll-target="#aic">AIC</a></li>
  <li><a href="#root-mean-squared-error" id="toc-root-mean-squared-error" class="nav-link" data-scroll-target="#root-mean-squared-error">Root Mean Squared Error</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Sampling oMS</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="project-and-data-vizualisation" class="level1">
<h1>Project and data vizualisation</h1>
<p>Visualize the pipeline analyses:</p>
<div class="cell">
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-d2f771db2441e37e5b5c" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-d2f771db2441e37e5b5c">{"x":{"nodes":{"name":["data_contact","data_id","data_obs","data_proxy","data_session","index","pcas_10","pcas_20","pcas_5","get_data_contact","load_data_id","load_data_obs","compute_oMS_and_proxy","get_data_session","get_pca"],"type":["stem","stem","stem","stem","stem","stem","stem","stem","stem","function","function","function","function","function","function"],"description":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"status":["uptodate","uptodate","uptodate","uptodate","uptodate","dispatched","uptodate","uptodate","uptodate","uptodate","uptodate","uptodate","uptodate","uptodate","uptodate"],"seconds":[0.946,0.112,0.011,0.037,0.015,4.915,0.284,0.265,0.832,null,null,null,null,null,null],"bytes":[18013,1605,49381,7050,558,2788423,329898,330145,329439,null,null,null,null,null,null],"branches":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"label":["data_contact","data_id","data_obs","data_proxy","data_session","index","pcas_10","pcas_20","pcas_5","get_data_contact","load_data_id","load_data_obs","compute_oMS_and_proxy","get_data_session","get_pca"],"color":["#354823","#354823","#354823","#354823","#354823","#DC863B","#354823","#354823","#354823","#354823","#354823","#354823","#354823","#354823","#354823"],"id":["data_contact","data_id","data_obs","data_proxy","data_session","index","pcas_10","pcas_20","pcas_5","get_data_contact","load_data_id","load_data_obs","compute_oMS_and_proxy","get_data_session","get_pca"],"level":[3,2,2,5,4,7,6,6,6,1,1,1,1,1,1],"shape":["dot","dot","dot","dot","dot","dot","dot","dot","dot","triangle","triangle","triangle","triangle","triangle","triangle"]},"edges":{"from":["data_proxy","get_pca","data_proxy","get_pca","data_contact","get_data_session","load_data_obs","data_proxy","get_pca","data_obs","get_data_contact","data_contact","data_id","data_obs","data_proxy","data_session","pcas_10","pcas_20","pcas_5","load_data_id","compute_oMS_and_proxy","data_contact","data_id","data_session"],"to":["pcas_5","pcas_5","pcas_20","pcas_20","data_session","data_session","data_obs","pcas_10","pcas_10","data_contact","data_contact","index","index","index","index","index","index","index","index","data_id","data_proxy","data_proxy","data_proxy","data_proxy"],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","physics":false},"manipulation":{"enabled":false},"edges":{"smooth":{"type":"cubicBezier","forceDirection":"horizontal"}},"physics":{"stabilization":false},"interaction":{"zoomSpeed":1},"layout":{"hierarchical":{"enabled":true,"direction":"LR"}}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":{"from":1,"to":1},"algorithm":"hierarchical","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":true,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"legend":{"width":0.2,"useGroups":false,"position":"right","ncol":1,"stepX":100,"stepY":100,"zoom":true,"nodes":{"label":["Up to date","Dispatched","Stem","Function"],"color":["#354823","#DC863B","#899DA4","#899DA4"],"shape":["dot","dot","dot","triangle"]},"nodesToDataframe":true},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 10%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">session</th>
<th style="text-align: left;">id</th>
<th style="text-align: right;">nb_flo_open</th>
<th style="text-align: right;">nb_poll_focal</th>
<th style="text-align: right;">oMS_fem_co5</th>
<th style="text-align: right;">oMS_fem_co10</th>
<th style="text-align: right;">oMS_fem_co20</th>
<th style="text-align: right;">oMS_mal_co5</th>
<th style="text-align: right;">oMS_mal_co10</th>
<th style="text-align: right;">oMS_mal_co20</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">1.FA1.01</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">1.FA1.02</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">1.FA1.03</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">1.FA1.04</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">1.FA1.05</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">1.FA1.06</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">9</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 3%">
<col style="width: 6%">
<col style="width: 6%">
<col style="width: 9%">
<col style="width: 17%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">session</th>
<th style="text-align: left;">people</th>
<th style="text-align: right;">time</th>
<th style="text-align: right;">duration</th>
<th style="text-align: left;">ID_full</th>
<th style="text-align: right;">ID</th>
<th style="text-align: right;">noHp</th>
<th style="text-align: left;">flow</th>
<th style="text-align: left;">id_flow</th>
<th style="text-align: left;">id_flow_full</th>
<th style="text-align: left;">ttt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">Jeanne</td>
<td style="text-align: right;">32.768</td>
<td style="text-align: right;">2.815</td>
<td style="text-align: left;">1.FA1.01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">1_1_3</td>
<td style="text-align: left;">1.FA1.01_1_3</td>
<td style="text-align: left;">1_low</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">Jeanne</td>
<td style="text-align: right;">36.822</td>
<td style="text-align: right;">3.327</td>
<td style="text-align: left;">1.FA1.06</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">NR</td>
<td style="text-align: left;">6_2_NR</td>
<td style="text-align: left;">1.FA1.06_2_NR</td>
<td style="text-align: left;">1_low</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">Jeanne</td>
<td style="text-align: right;">56.448</td>
<td style="text-align: right;">8.191</td>
<td style="text-align: left;">1.FA1.03</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">8</td>
<td style="text-align: left;">3_1_8</td>
<td style="text-align: left;">1.FA1.03_1_8</td>
<td style="text-align: left;">1_low</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">Jeanne</td>
<td style="text-align: right;">67.371</td>
<td style="text-align: right;">12.628</td>
<td style="text-align: left;">1.FA1.01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">NR</td>
<td style="text-align: left;">1_1_NR</td>
<td style="text-align: left;">1.FA1.01_1_NR</td>
<td style="text-align: left;">1_low</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">Jeanne</td>
<td style="text-align: right;">80.000</td>
<td style="text-align: right;">1.023</td>
<td style="text-align: left;">1.FA1.01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">1_1_3</td>
<td style="text-align: left;">1.FA1.01_1_3</td>
<td style="text-align: left;">1_low</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">Jeanne</td>
<td style="text-align: right;">81.024</td>
<td style="text-align: right;">28.650</td>
<td style="text-align: left;">1.FA1.01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">1_1_4</td>
<td style="text-align: left;">1.FA1.01_1_4</td>
<td style="text-align: left;">1_low</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="what-is-the-best-proxy-for-observational-mating-success" class="level1">
<h1>What is the best proxy for observational mating success?</h1>
<p>We have conducted an experiment in which we surveyed each pollinator one by one along the visit sequences, up to the flower scale. By making assumptions about the carry-over (i.e., the number of successive flower visits during which pollen export remains effective), we are able to estimate the number of observational sexual partners, both for the female and the male function. We assume that the carry-over is about 10, based on a previous study on the sister species <em>Brassica napus</em>: for the male function, 91% of the seeds were sired in the first four flowers visited after a focal individual, and no seeds were sired after the 14th flower visited <span class="citation" data-cites="cresswell_method_1994">[<a href="#ref-cresswell_method_1994" role="doc-biblioref">1</a>]</span>.</p>
<p>Now, we imagine a more common experiment <em>in natura</em> in which we cannot follow the pollinators one by one. We could rather observe plant by plant. We then have the following data :</p>
<ul>
<li>the number of arrivals (female function) / departures (male function) per individual, which are highly correlated = number of contacts (which may be independent or not) per individual<br>
</li>
<li>the total number of visits per individual<br>
</li>
<li>the total visit duration per individual (but not useful here, as we only formulate hypotheses about visit sequences, without getting interested in the number of pollen grains exported/deposited): we leave that aside</li>
</ul>
<p>We can imagine that each observer notes the time of the pollinator’s arrival on each plant (start), to order events of contacts:</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 22%">
<col style="width: 8%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 21%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">session</th>
<th style="text-align: left;">people</th>
<th style="text-align: left;">id</th>
<th style="text-align: right;">consecutive_contact</th>
<th style="text-align: right;">start</th>
<th style="text-align: right;">nb_visit</th>
<th style="text-align: right;">duration</th>
<th style="text-align: right;">no_contact_with_id</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">Jeanne</td>
<td style="text-align: left;">1.FA1.01</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">32.768</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.815</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">Jeanne</td>
<td style="text-align: left;">1.FA1.06</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">36.822</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.327</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">Jeanne</td>
<td style="text-align: left;">1.FA1.03</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">56.448</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8.191</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">Jeanne</td>
<td style="text-align: left;">1.FA1.01</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">67.371</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">105.677</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">Jeanne</td>
<td style="text-align: left;">1.FA1.06</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">183.382</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">10.877</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">Jeanne</td>
<td style="text-align: left;">1.FA1.01</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">201.195</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">13.056</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>But then, what to do with this? We don’t know the identity of the pollinator,<br>
so it is difficult to infer anything from the visit order…</p>
<p>Something more realistic is to start from data at the individual level without inferring anything about the effect of visit order:</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">session</th>
<th style="text-align: left;">id</th>
<th style="text-align: right;">nb_contact</th>
<th style="text-align: right;">nb_visit</th>
<th style="text-align: right;">dur_visit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">1.FA1.01</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">213.846</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">1.FA1.02</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">76.402</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">1.FA1.03</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">84.098</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">1.FA1.04</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">118.506</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">1.FA1.05</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">65.717</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">1.FA1.06</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">157.325</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>To discuss: something smart to do with contact order?</p>
<p>Then, we can summarize data at the scale of the observation session. At least useful to compare<br>
populations between them? We can get the following data:</p>
<ul>
<li>Total number of contacts with id</li>
<li>Total number of visits<br>
</li>
<li>Total number of visited individuals (maximum oMS)<br>
</li>
<li>Total number of pollinators (but see below)<br>
</li>
<li>Total visit duration (but again, we leave that aside)</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 22%">
<col style="width: 19%">
<col style="width: 19%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">session</th>
<th style="text-align: right;">max_oMS</th>
<th style="text-align: right;">total_nb_contact</th>
<th style="text-align: right;">total_nb_visit</th>
<th style="text-align: right;">total_duration</th>
<th style="text-align: right;">total_nb_poll</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">73</td>
<td style="text-align: right;">197</td>
<td style="text-align: right;">1196.761</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.FA2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">124</td>
<td style="text-align: right;">1098.092</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.FO1</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">62</td>
<td style="text-align: right;">486</td>
<td style="text-align: right;">3642.479</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.FO2</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">373</td>
<td style="text-align: right;">3178.549</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.MO1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">185</td>
<td style="text-align: right;">1509.840</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.MO2</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">1463.275</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Because, imagine that one individual had a lot of contacts with pollinators, but<br>
that only a few other individuals were visited: this should weaken the link between<br>
the number of contacts per id and oMS.</p>
<p>Using the data table with contacts ordered by time, we could imagine estimating<br>
the diversity of potential sexual partners according to their relative frequency<br>
(e.g., using Hill/Shannon/Simpson indices).</p>
<p>NB: In our experiment, we know for sure the number of pollinators that visited<br>
plants. <em>In natura</em>, it would be much more difficult, but we could at least get an estimation<br>
based on the species diversity that we observed (i.e., if we observed<br>
two contacts by <em>Bombus</em> and one contact by <em>Apis</em>, there are at least two different<br>
pollinators).</p>
<p>We now investigate which proxy best correlates with the observational number of mates.<br>
We estimate the latter using a carry-over of 10, as well as 5 and 20. We thus<br>
have two main proxies:</p>
<ul>
<li><ol type="A">
<li>the number of contacts per individual<br>
</li>
</ol></li>
<li><ol start="2" type="A">
<li>the total number of visits per individual</li>
</ol></li>
</ul>
<ol type="A">
<li>For the number of contacts per individual, we can explore its correlation with<br>
oMS using:<br>
</li>
</ol>
<ul>
<li>index_A1: the raw number of contacts per individual<br>
</li>
<li>index_A2: relativized by the total number of contacts in the session<br>
</li>
<li>index_A3: multiplied by the total number of potential sexual partners<br>
</li>
<li>index_A4: combining index_A2 and index_A3<br>
</li>
<li>index_A5 (optional, to discuss): index_A4 divided by the total number of pollinators</li>
</ul>
<ol start="2" type="A">
<li>For the total number of visits per individual:<br>
</li>
</ol>
<ul>
<li>index_B1: the raw number of visits per individual<br>
</li>
<li>index_B2: relativized by the total number of visits in the session<br>
</li>
<li>index_B3: multiplied by the total number of potential sexual partners<br>
</li>
<li>index_B4: combining index_B2 and index_B3<br>
</li>
<li>index_B5 (optional, to discuss): index_B4 divided by the total number of pollinators</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 2%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 5%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 4%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 2%">
<col style="width: 3%">
<col style="width: 3%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">session</th>
<th style="text-align: left;">id</th>
<th style="text-align: right;">nb_flo_open</th>
<th style="text-align: right;">nb_poll_focal</th>
<th style="text-align: right;">oMS_fem_co5</th>
<th style="text-align: right;">oMS_fem_co10</th>
<th style="text-align: right;">oMS_fem_co20</th>
<th style="text-align: right;">oMS_mal_co5</th>
<th style="text-align: right;">oMS_mal_co10</th>
<th style="text-align: right;">oMS_mal_co20</th>
<th style="text-align: right;">nb_contact</th>
<th style="text-align: right;">nb_visit</th>
<th style="text-align: right;">dur_visit</th>
<th style="text-align: right;">max_oMS</th>
<th style="text-align: right;">total_nb_contact</th>
<th style="text-align: right;">total_nb_visit</th>
<th style="text-align: right;">total_duration</th>
<th style="text-align: right;">total_nb_poll</th>
<th style="text-align: right;">index_A1</th>
<th style="text-align: right;">index_A2</th>
<th style="text-align: right;">index_A3</th>
<th style="text-align: right;">index_A4</th>
<th style="text-align: right;">index_A5</th>
<th style="text-align: right;">index_B1</th>
<th style="text-align: right;">index_B2</th>
<th style="text-align: right;">index_B3</th>
<th style="text-align: right;">index_B4</th>
<th style="text-align: right;">index_B5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">1.FA1.01</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">213.846</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">73</td>
<td style="text-align: right;">197</td>
<td style="text-align: right;">1196.761</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.1369863</td>
<td style="text-align: right;">100</td>
<td style="text-align: right;">1.3698630</td>
<td style="text-align: right;">1.3698630</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">0.1269036</td>
<td style="text-align: right;">250</td>
<td style="text-align: right;">1.2690355</td>
<td style="text-align: right;">1.3698630</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">1.FA1.02</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">76.402</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">73</td>
<td style="text-align: right;">197</td>
<td style="text-align: right;">1196.761</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.0684932</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">0.6849315</td>
<td style="text-align: right;">0.6849315</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0.0710660</td>
<td style="text-align: right;">140</td>
<td style="text-align: right;">0.7106599</td>
<td style="text-align: right;">0.6849315</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">1.FA1.03</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">84.098</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">73</td>
<td style="text-align: right;">197</td>
<td style="text-align: right;">1196.761</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.1095890</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">1.0958904</td>
<td style="text-align: right;">1.0958904</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0.0862944</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">0.8629442</td>
<td style="text-align: right;">1.0958904</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">1.FA1.04</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">118.506</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">73</td>
<td style="text-align: right;">197</td>
<td style="text-align: right;">1196.761</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.1095890</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">1.0958904</td>
<td style="text-align: right;">1.0958904</td>
<td style="text-align: right;">23</td>
<td style="text-align: right;">0.1167513</td>
<td style="text-align: right;">230</td>
<td style="text-align: right;">1.1675127</td>
<td style="text-align: right;">1.0958904</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">1.FA1.05</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">65.717</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">73</td>
<td style="text-align: right;">197</td>
<td style="text-align: right;">1196.761</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.0821918</td>
<td style="text-align: right;">60</td>
<td style="text-align: right;">0.8219178</td>
<td style="text-align: right;">0.8219178</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">0.0609137</td>
<td style="text-align: right;">120</td>
<td style="text-align: right;">0.6091371</td>
<td style="text-align: right;">0.8219178</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.FA1</td>
<td style="text-align: left;">1.FA1.06</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">157.325</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">73</td>
<td style="text-align: right;">197</td>
<td style="text-align: right;">1196.761</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0.1095890</td>
<td style="text-align: right;">80</td>
<td style="text-align: right;">1.0958904</td>
<td style="text-align: right;">1.0958904</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">0.1472081</td>
<td style="text-align: right;">290</td>
<td style="text-align: right;">1.4720812</td>
<td style="text-align: right;">1.0958904</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Okay now we proceed to ACP.</p>
<section id="acp" class="level2">
<h2 class="anchored" data-anchor-id="acp">ACP</h2>
<section id="carry-over-10" class="level3">
<h3 class="anchored" data-anchor-id="carry-over-10">Carry-over 10</h3>
<div class="grid">
<section id="females" class="level4 g-col-6">
<h4 class="anchored" data-anchor-id="females">Females</h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="males" class="level4 g-col-6">
<h4 class="anchored" data-anchor-id="males">Males</h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</div>
</section>
<section id="carry-over-5" class="level3">
<h3 class="anchored" data-anchor-id="carry-over-5">Carry-over 5</h3>
<div class="grid">
<section id="females-1" class="level4 g-col-6">
<h4 class="anchored" data-anchor-id="females-1">Females</h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="males-1" class="level4 g-col-6">
<h4 class="anchored" data-anchor-id="males-1">Males</h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</div>
</section>
<section id="carry-over-20" class="level3">
<h3 class="anchored" data-anchor-id="carry-over-20">Carry-over 20</h3>
<div class="grid">
<section id="females-2" class="level4 g-col-6">
<h4 class="anchored" data-anchor-id="females-2">Females</h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="males-2" class="level4 g-col-6">
<h4 class="anchored" data-anchor-id="males-2">Males</h4>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</div>
<p>The three best based on PCA : index_A3, index_B3 and index A_1. From now on we focus solely on a carry-over of 10, as it’s very similar.</p>
</section>
</section>
<section id="correlation-test" class="level2">
<h2 class="anchored" data-anchor-id="correlation-test">Correlation test</h2>
<div class="grid">
<section id="females-3" class="level4 g-col-6">
<h4 class="anchored" data-anchor-id="females-3">Females</h4>
<p><strong>A1</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_proxy$oMS_fem_co10 and data_proxy$index_A1
t = 11.381, df = 136, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.6015364 0.7750788
sample estimates:
      cor 
0.6984348 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  data_proxy$oMS_fem_co10 and data_proxy$index_A1
S = 109846, p-value &lt; 2.2e-16
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.7492027 </code></pre>
</div>
</div>
<p><strong>A2</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_proxy$oMS_fem_co10 and data_proxy$index_A2
t = -0.52347, df = 136, p-value = 0.6015
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.2103704  0.1231860
sample estimates:
        cor 
-0.04484194 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  data_proxy$oMS_fem_co10 and data_proxy$index_A2
S = 395711, p-value = 0.2601
alternative hypothesis: true rho is not equal to 0
sample estimates:
       rho 
0.09652734 </code></pre>
</div>
</div>
<p><strong>A3</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_proxy$oMS_fem_co10 and data_proxy$index_A3
t = 13.653, df = 136, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.6796225 0.8229165
sample estimates:
      cor 
0.7603731 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  data_proxy$oMS_fem_co10 and data_proxy$index_A3
S = 84479, p-value &lt; 2.2e-16
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.8071208 </code></pre>
</div>
</div>
<p><strong>A4</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_proxy$oMS_fem_co10 and data_proxy$index_A4
t = 3.2682, df = 136, p-value = 0.00137
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.1075987 0.4181027
sample estimates:
      cor 
0.2698515 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  data_proxy$oMS_fem_co10 and data_proxy$index_A4
S = 288311, p-value = 4.092e-05
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.3417384 </code></pre>
</div>
</div>
<p><strong>A5</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_proxy$oMS_fem_co10 and data_proxy$index_A5
t = -1.9169, df = 136, p-value = 0.05734
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.320614804  0.005041439
sample estimates:
    cor 
-0.1622 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  data_proxy$oMS_fem_co10 and data_proxy$index_A5
S = 463225, p-value = 0.5021
alternative hypothesis: true rho is not equal to 0
sample estimates:
        rho 
-0.05761802 </code></pre>
</div>
</div>
<p><strong>B1</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_proxy$oMS_fem_co10 and data_proxy$index_B1
t = 6.6539, df = 136, p-value = 6.414e-10
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.3581291 0.6119994
sample estimates:
      cor 
0.4955762 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  data_proxy$oMS_fem_co10 and data_proxy$index_B1
S = 194058, p-value = 1.306e-12
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.5569332 </code></pre>
</div>
</div>
<p><strong>B2</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_proxy$oMS_fem_co10 and data_proxy$index_B2
t = -0.25705, df = 136, p-value = 0.7975
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.1884475  0.1456044
sample estimates:
       cor 
-0.0220366 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  data_proxy$oMS_fem_co10 and data_proxy$index_B2
S = 374554, p-value = 0.0901
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.1448333 </code></pre>
</div>
</div>
<p><strong>B3</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_proxy$oMS_fem_co10 and data_proxy$index_B3
t = 7.394, df = 136, p-value = 1.317e-11
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.4045660 0.6448723
sample estimates:
      cor 
0.5354704 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  data_proxy$oMS_fem_co10 and data_proxy$index_B3
S = 160442, p-value &lt; 2.2e-16
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.6336852 </code></pre>
</div>
</div>
<p><strong>B4</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_proxy$oMS_fem_co10 and data_proxy$index_B4
t = 2.2365, df = 136, p-value = 0.02695
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.02193452 0.34460763
sample estimates:
     cor 
0.188349 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  data_proxy$oMS_fem_co10 and data_proxy$index_B4
S = 309817, p-value = 0.0004958
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.2926366 </code></pre>
</div>
</div>
<p><strong>B5</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_proxy$oMS_fem_co10 and data_proxy$index_B5
t = -1.9169, df = 136, p-value = 0.05734
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.320614804  0.005041439
sample estimates:
    cor 
-0.1622 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  data_proxy$oMS_fem_co10 and data_proxy$index_B5
S = 463225, p-value = 0.5021
alternative hypothesis: true rho is not equal to 0
sample estimates:
        rho 
-0.05761802 </code></pre>
</div>
</div>
</section>
<section id="males-3" class="level4 g-col-6">
<h4 class="anchored" data-anchor-id="males-3">Males</h4>
<p><strong>A1</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_proxy$oMS_mal_co10 and data_proxy$index_A1
t = 12.122, df = 136, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.6293332 0.7923391
sample estimates:
      cor 
0.7206511 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  data_proxy$oMS_mal_co10 and data_proxy$index_A1
S = 104123, p-value &lt; 2.2e-16
alternative hypothesis: true rho is not equal to 0
sample estimates:
    rho 
0.76227 </code></pre>
</div>
</div>
<p><strong>A2</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_proxy$oMS_mal_co10 and data_proxy$index_A2
t = -0.16192, df = 136, p-value = 0.8716
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.1805694  0.1535777
sample estimates:
        cor 
-0.01388345 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  data_proxy$oMS_mal_co10 and data_proxy$index_A2
S = 398429, p-value = 0.2921
alternative hypothesis: true rho is not equal to 0
sample estimates:
       rho 
0.09032237 </code></pre>
</div>
</div>
<p><strong>A3</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_proxy$oMS_mal_co10 and data_proxy$index_A3
t = 14.541, df = 136, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.7049039 0.8379812
sample estimates:
      cor 
0.7801166 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  data_proxy$oMS_mal_co10 and data_proxy$index_A3
S = 77512, p-value &lt; 2.2e-16
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.8230266 </code></pre>
</div>
</div>
<p><strong>A4</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_proxy$oMS_mal_co10 and data_proxy$index_A4
t = 3.6489, df = 136, p-value = 0.0003743
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.1384167 0.4435846
sample estimates:
      cor 
0.2986146 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  data_proxy$oMS_mal_co10 and data_proxy$index_A4
S = 283390, p-value = 2.173e-05
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.3529735 </code></pre>
</div>
</div>
<p><strong>A5</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_proxy$oMS_mal_co10 and data_proxy$index_A5
t = -1.8643, df = 136, p-value = 0.06444
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.316610047  0.009498434
sample estimates:
      cor 
-0.157857 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  data_proxy$oMS_mal_co10 and data_proxy$index_A5
S = 470381, p-value = 0.3886
alternative hypothesis: true rho is not equal to 0
sample estimates:
        rho 
-0.07395657 </code></pre>
</div>
</div>
<p><strong>B1</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_proxy$oMS_mal_co10 and data_proxy$index_B1
t = 6.6886, df = 136, p-value = 5.368e-10
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.3603790 0.6136126
sample estimates:
      cor 
0.4975225 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  data_proxy$oMS_mal_co10 and data_proxy$index_B1
S = 195666, p-value = 1.963e-12
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.5532618 </code></pre>
</div>
</div>
<p><strong>B2</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_proxy$oMS_mal_co10 and data_proxy$index_B2
t = -0.35112, df = 136, p-value = 0.726
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.1962127  0.1377027
sample estimates:
        cor 
-0.03009462 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  data_proxy$oMS_mal_co10 and data_proxy$index_B2
S = 386699, p-value = 0.1714
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.1171035 </code></pre>
</div>
</div>
<p><strong>B3</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_proxy$oMS_mal_co10 and data_proxy$index_B3
t = 7.4052, df = 136, p-value = 1.239e-11
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.4052485 0.6453488
sample estimates:
      cor 
0.5360524 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  data_proxy$oMS_mal_co10 and data_proxy$index_B3
S = 160222, p-value &lt; 2.2e-16
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.6341882 </code></pre>
</div>
</div>
<p><strong>B4</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_proxy$oMS_mal_co10 and data_proxy$index_B4
t = 2.1615, df = 136, p-value = 0.03241
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.0156129 0.3390227
sample estimates:
      cor 
0.1822423 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  data_proxy$oMS_mal_co10 and data_proxy$index_B4
S = 319974, p-value = 0.001394
alternative hypothesis: true rho is not equal to 0
sample estimates:
      rho 
0.2694464 </code></pre>
</div>
</div>
<p><strong>B5</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  data_proxy$oMS_mal_co10 and data_proxy$index_B5
t = -1.8643, df = 136, p-value = 0.06444
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.316610047  0.009498434
sample estimates:
      cor 
-0.157857 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Spearman's rank correlation rho

data:  data_proxy$oMS_mal_co10 and data_proxy$index_B5
S = 470381, p-value = 0.3886
alternative hypothesis: true rho is not equal to 0
sample estimates:
        rho 
-0.07395657 </code></pre>
</div>
</div>
</section>
</div>
<p>The best proxies : A3 &gt; A1 &gt; B3 &gt; B1. From now we only focus on these indexes, and we just check on females as we have the same results.</p>
</section>
<section id="linear-models-and-r2" class="level2">
<h2 class="anchored" data-anchor-id="linear-models-and-r2">Linear models and R<sup>2</sup></h2>
<p><strong>A3</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: oMS_fem_co10 ~ index_A3 + (1 | session)
   Data: data_proxy

REML criterion at convergence: 479

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.44166 -0.55337  0.08977  0.59748  2.08133 

Random effects:
 Groups   Name        Variance Std.Dev.
 session  (Intercept) 2.342    1.530   
 Residual             1.297    1.139   
Number of obs: 138, groups:  session, 16

Fixed effects:
            Estimate Std. Error t value
(Intercept) 4.078995   0.440473   9.260
index_A3    0.038894   0.004743   8.201

Correlation of Fixed Effects:
         (Intr)
index_A3 -0.441</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.732
     Marginal R2: 0.247</code></pre>
</div>
</div>
<p><strong>A1</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: oMS_fem_co10 ~ index_A1 + (1 | session)
   Data: data_proxy

REML criterion at convergence: 476.1

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.43218 -0.52535  0.07917  0.55842  2.12807 

Random effects:
 Groups   Name        Variance Std.Dev.
 session  (Intercept) 2.963    1.721   
 Residual             1.278    1.131   
Number of obs: 138, groups:  session, 16

Fixed effects:
            Estimate Std. Error t value
(Intercept)  4.10334    0.48329    8.49
index_A1     0.35020    0.04405    7.95

Correlation of Fixed Effects:
         (Intr)
index_A1 -0.407</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.754
     Marginal R2: 0.184</code></pre>
</div>
</div>
<p><strong>B3</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: oMS_fem_co10 ~ index_B3 + (1 | session)
   Data: data_proxy

REML criterion at convergence: 517.2

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.29297 -0.58803  0.08513  0.61277  2.32355 

Random effects:
 Groups   Name        Variance Std.Dev.
 session  (Intercept) 3.955    1.989   
 Residual             1.613    1.270   
Number of obs: 138, groups:  session, 16

Fixed effects:
             Estimate Std. Error t value
(Intercept) 5.0383082  0.5275995   9.549
index_B3    0.0030535  0.0006697   4.560

Correlation of Fixed Effects:
         (Intr)
index_B3 -0.261</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.729
     Marginal R2: 0.065</code></pre>
</div>
</div>
<p><strong>B1</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: oMS_fem_co10 ~ index_B1 + (1 | session)
   Data: data_proxy

REML criterion at convergence: 512.2

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.27002 -0.56989  0.09919  0.59569  2.33706 

Random effects:
 Groups   Name        Variance Std.Dev.
 session  (Intercept) 4.14     2.035   
 Residual             1.60     1.265   
Number of obs: 138, groups:  session, 16

Fixed effects:
            Estimate Std. Error t value
(Intercept) 5.005645   0.539892   9.272
index_B1    0.029895   0.006508   4.594

Correlation of Fixed Effects:
         (Intr)
index_B1 -0.266</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># R2 for Mixed Models

  Conditional R2: 0.738
     Marginal R2: 0.059</code></pre>
</div>
</div>
<p>Based on marginal, A3 is the best proxy, but based on conditionnal, A1 is better.</p>
</section>
<section id="aic" class="level2">
<h2 class="anchored" data-anchor-id="aic">AIC</h2>
<p><strong>A3</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 486.9907</code></pre>
</div>
</div>
<p><strong>A1</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 484.1203</code></pre>
</div>
</div>
<p><strong>B3</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 525.1529</code></pre>
</div>
</div>
<p><strong>B1</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 520.238</code></pre>
</div>
</div>
<p>Best AIC is for A1.</p>
</section>
<section id="root-mean-squared-error" class="level2">
<h2 class="anchored" data-anchor-id="root-mean-squared-error">Root Mean Squared Error</h2>
<p><strong>A3</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "RMSE: 1.07060689384694"</code></pre>
</div>
</div>
<p><strong>A1</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "RMSE: 1.06208041730774"</code></pre>
</div>
</div>
<p><strong>B3</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "RMSE: 1.19281847098643"</code></pre>
</div>
</div>
<p><strong>B1</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "RMSE: 1.18765895202105"</code></pre>
</div>
</div>

</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" role="list">
<div id="ref-cresswell_method_1994" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">Cresswell JE. 1994 A method for quantifying the gene flow that results from a single bumblebee visit using transgenic oilseed rape,<em><span>Brassica</span> napus</em> <span>L</span>. Cv. <span>Westar</span>. <em>Transgenic Research</em> <strong>3</strong>, 134–137. (doi:<a href="https://doi.org/10.1007/BF01974092">10.1007/BF01974092</a>)</div>
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>